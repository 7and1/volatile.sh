# Wrangler Configuration Template
# Copy this file to wrangler.toml and fill in your values
# NEVER commit wrangler.toml - it's in .gitignore

# account_id is set via environment variable CLOUDFLARE_ACCOUNT_ID
# Export it before running wrangler: export CLOUDFLARE_ACCOUNT_ID=your_account_id

name = "volatile-sh"
main = "src/index.js"
compatibility_date = "2024-12-01"

# Workers.dev domain
workers_dev = true

# Serve static files from /dist
[assets]
directory = "./dist"

# KV namespace for security data
# Create your own KV namespace: wrangler kv:namespace create "SECURITY_KV"
[[kv_namespaces]]
binding = "SECURITY_KV"
id = "YOUR_KV_NAMESPACE_ID"

# Durable Object bindings
[[durable_objects.bindings]]
name = "SECRETS"
class_name = "SecretStore"

[[durable_objects.bindings]]
name = "RATE_LIMIT"
class_name = "RateLimiter"

# Durable Object migrations
[[migrations]]
tag = "v1"
new_classes = ["SecretStore"]

[[migrations]]
tag = "v2"
new_classes = ["RateLimiter"]

# Environment variables
[vars]
ENVIRONMENT = "development"

# ============================================================================
# STAGING ENVIRONMENT
# ============================================================================
[env.staging]
name = "volatile-sh-staging"
workers_dev = true

[env.staging.vars]
ENVIRONMENT = "staging"
LOG_LEVEL = "debug"

# Create staging KV: wrangler kv:namespace create "SECURITY_KV" --env staging
[[env.staging.kv_namespaces]]
binding = "SECURITY_KV"
id = "YOUR_STAGING_KV_NAMESPACE_ID"

[[env.staging.durable_objects.bindings]]
name = "SECRETS"
class_name = "SecretStore"

[[env.staging.durable_objects.bindings]]
name = "RATE_LIMIT"
class_name = "RateLimiter"

# ============================================================================
# PRODUCTION ENVIRONMENT
# ============================================================================
[env.production]
name = "volatile-sh"
workers_dev = true

[env.production.vars]
ENVIRONMENT = "production"
LOG_LEVEL = "warn"

# Create production KV: wrangler kv:namespace create "SECURITY_KV" --env production
[[env.production.kv_namespaces]]
binding = "SECURITY_KV"
id = "YOUR_PRODUCTION_KV_NAMESPACE_ID"

[[env.production.durable_objects.bindings]]
name = "SECRETS"
class_name = "SecretStore"

[[env.production.durable_objects.bindings]]
name = "RATE_LIMIT"
class_name = "RateLimiter"
